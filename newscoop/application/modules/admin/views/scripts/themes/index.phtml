
<div class="ui-widget-content small-block themesListHolder">
	<div class="tabs ui-tabs ui-widget ui-widget-content ui-corner-all">
    	<ul class="themesListTabsBtns ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
        	<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active">
        		<a href="javascript:void(0)">Available themes</a>
        	</li>
        	<?php foreach( $this->publications as $pub ) : ?>
        		<li class="ui-state-default ui-corner-top">
        		    <a href="javascript:void(0)" pub-id="<?php echo $pub->getId(); ?>"><?php echo $pub->getName(); ?></a>
        		</li> 
        	<?php endforeach; ?>
		</ul>
        <a href="#" id="addNewPublication">Add new Publication</a>
        <div id="tabs-1">
		
            <?php echo $this->mytable; ?>
		
		</div>
	</div>
</div>	

<script id="datatableTmpl_0" type="text/x-jQuery-tmpl">
<div>
	<div class="DataTables_sort_wrapper">
    	<input class="toggle-checkbox" type="checkbox">
        <span></span>
	</div>
</div>
</script>

<script id="datatableTmpl_1" type="text/x-jQuery-tmpl">
	<div class="imageItem ui-tabs-hide" id="themesListTabD">
    	<a id="example1" href="${image}">
			<img src="${image}" alt="${image}" />
		</a>
	</div>
</script>

<script id="datatableTmpl_2" type="text/x-jQuery-tmpl">

	<div class="themesListTabs ui-tabs">
		<h3>${title} <span>// <?php echo getGS( 'version' ) ?> ${version}</span></h3>
        <p><i><b><?php echo getGS( 'Design' ) ?>:</b> ${designer}</i></p>
		<ul class="imageCtrls ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
            <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active">
				<a href="javascript:void(0)">
                    <?php echo getGS( 'Issue page' ) ?>
					<span><?php echo getGS( 'Click to enlarge' ) ?></span>
				</a>
			</li>
            <li class="ui-state-default ui-corner-top">
				<a href="javascript:void(0)">
					<?php echo getGS( 'Section page' ); ?>
					<span><?php echo getGS( 'Click to enlarge' ) ?></span>
				</a>
			</li>
        	<li class="ui-state-default ui-corner-top">
				<a href="javascript:void(0)">
                    <?php echo getGS( 'Article page' ) ?>
					<span><?php echo getGS( 'Click to enlarge' ) ?></span>
				</a>
			</li>
    	</ul>
	</div>

</script>

<script id="datatableTmpl_3" type="text/x-jQuery-tmpl">
<div>
	<span class="compatibilityTitle">${compat}</span>
	<i>${text}</i>
</div>
</script>

<script id="datatableTmpl_4" type="text/x-jQuery-tmpl">
<div>
	<ul class="actionDropDown">
    	<li>
        	<a href="#">Actions</a>
			<ul class="block-shadow">
				<li>
					<a href="#" class="add"><span>Add to publication</span></a>
					<ul class="block-shadow">
						<?php foreach( $this->publications as $pub ) : ?>
						<li>
        		    		<a href="javascript:void(0)" pub-id="<?php echo $pub->getId(); ?>"><?php echo $pub->getName(); ?></a>
        				</li> 
        	            <?php endforeach; ?>
					</ul>
				</li>
            	<li><a href="#" class="delete">Delete</a></li>
			</ul>
		</li>
	</ul>
</div>
</script>

<script type="text/javascript">
function log( x ){ console.log( x ); }
newscoopDatatables =
{
	callbackRow : function( node, strings, dispIndex, theIndex )
	{
		for( i in strings )
		{
			if( $.trim( strings[i] ) == "" ) continue;
			
			eval( "var theData = " + strings[i] );
			try
			{
				var theTd = $( node ).children().eq( i ).html( "" );
				$( "#datatableTmpl_" + i ).tmpl( theData ).appendTo( theTd );
			}
			catch( e ){ console.log( e ); }
		}
		return node;
	},
	callbackDraw : function()
	{
		//$('.themesListTabs').tabs({event: 'mouseover'});
		$('.themesListTabs li a').mouseover( function()
		{
			var parentLi = $(this).parent( 'li' );
			parentLi.siblings().removeClass( 'ui-tabs-selected ui-state-active' );
			parentLi.addClass( 'ui-tabs-selected ui-state-active' );

			var idx = parentLi.parent('ul').find( 'li' ).index( parentLi );
			var imgs = $(this).parents( 'td' ).eq(0).prev().find( 'div' );
			imgs.addClass( 'ui-tabs-hide' ).eq( idx ).removeClass( 'ui-tabs-hide' );
		});

		$(".themesListTabs div a").fancybox();
		
		$(".actionDropDown li").hover(function()
		{
			$(this).children("ul").css("display","block");
			$(this).children("a").addClass("active");
		}, function() 
		{
			$(this).children("ul").css("display","none");
			$(this).children("a").removeClass("active");
		});
		$(".actionDropDown li ul li").hover(function()
		{
			$(this).children("ul").css("display","block");
		}, function() 
		{
			$(this).childer("ul").css("display","none");
		});
	}
}
$( function()
{
	$('.themesListHolder .themesListTabsBtns li a').click( function()
	{
		var parentLi = $(this).parent();
		parentLi.siblings().removeClass( 'ui-tabs-selected ui-state-active' );
		parentLi.addClass('ui-tabs-selected ui-state-active');

		var datatable = $( document.body ).data( 'newscoop.themesDatatable' );
		var pubId 	  = $(this).attr( 'pub-id' );
		if( pubId )
			datatable.fnFilter( pubId, 4 );
		else
		{
			datatable.fnSettings().aoPreSearchCols[4].sSearch = ""; // hacked
			datatable.fnFilter( "" );
		}
	})
});
</script>
 
