<?php $this->headLink()->appendStylesheet($this->baseUrl('/admin-style/comments.css')); ?>
<h2><?php echo $this->name; ?></h2>
<h1><?php putGS('Comments'); ?></h1>
<div class="wrapper">
  <div class="ui-widget-content small-block block-shadow commentsHolder">
    <div class="padded clearfix inner-tabs">
      <div class="tabs">
        <ul>
          <li><a href="#tabs-1">Comments</a></li>
          <li><a href="#tabs-2">Users</a></li>
        </ul>
        <div id="tabs-1">
<div id="showComments">
<fieldset>
<legend><?php putGS('Show');?></legend>
<ul class="status_filter">
    <li class="published">
        <input type="checkbox" id="show_published" value="approved">
        <label for="show_published"><?php putGS('Published');?></label>
    </li>
    <li class="new">
        <input type="checkbox" id="show_new" value="pending">
        <label for="show_new"><?php putGS('New');?></label>
    </li>
    <li class="approved" style="display: none;">
        <input type="checkbox" id="show_approved" value="approved">
        <label for="show_approved"><?php putGS('Approved');?></label>
    </li>
    <li class="hidden">
        <input type="checkbox" id="show_hidden" value="hidden">
        <label for="show_hidden"><?php putGS('Hidden');?></label>
    </li>
    <li class="deleted">
        <input type="checkbox" id="show_deleted" value="deleted">
        <label for="show_deleted"><?php putGS('Deleted');?></label>
    </li>
</ul>
<script type="text/javascript">
$('.status_filter li').click(function(evt){
    var ck = $(this).find('input[type="checkbox"]');
    var checked = true;
    if (ck.attr("checked")) {
        checked = false;
        ck.removeAttr("checked");
    }
    else
        ck.attr("checked","checked");
    datatableCallback.serverData[ck.val()] = checked;
    datatable.fnDraw();
    evt.preventDefault();
});
</script>
</fieldset>
</div>
<?php $this->renderDatatable(); ?>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
var datatableCallback = {
	serverData: {},
	row: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
	    that = datatableCallback;
        var tr = $('<tr></tr>');
        tr.addClass(that.rowIndex%2?'list_row_odd odd':'list_row_even even');
        tr.hover(function() {
        	   $(this).find(".commentBtns").css("visibility","visible");
            },function() {
            	$(this).find(".commentBtns").css("visibility","hidden");
            });
        var td = $('<td></td>');
        td.attr('colspan',5);
        nRow = $(nRow);
        actions = nRow.find('.commentThreadOrder').first();
        nRow.find('.commentTimeCreated').removeClass('commentTimeCreated').addClass('commentMessage');//.attr('colspan',2);
        nActions = actions.clone();
        actions.hide();
        td.append($('<table cellspacing="0" cellpadding="0">').append(nRow));
        td.append(nActions.html());
        jRow = tr.append(td);
        that.rowIndex++;
        return jRow.get(0);
    },
    addServerData: function ( sSource, aoData, fnCallback ) {
    	that = datatableCallback;
        for(i in that.serverData) {
            if(that.serverData[i])
                aoData.push({"name": "sFilter[status][]", "value": i});
        }
    	$.getJSON( sSource, aoData, function (json) {
    		fnCallback(json);
    	});
    }
}
</script>